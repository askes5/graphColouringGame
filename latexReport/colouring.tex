\chapter{Colouring}

%TODO add deference between colouring and marking game

\begin{definition}
    Let $G$ be a graph. Then, $\chi_g(G)$ is the smallest number of colours need to guarantee that Alice has a winning strategy on $G$. 
    
\end{definition}

\begin{definition}
    We extend the colouring game to have $p$ players. The game choromatic number for $p$ players on some graph $G$ is $\chi_g(G;p)$. Note: $\chi_g(G) = \chi_g(G;2)$.
\end{definition}

\begin{theorem}
    Let $\mathcal{T}$ be the family of trees. If we have $p \geq 2$ players then,
    \[\chi_g(\mathcal{T};p) \geq p + 2 \]
\end{theorem}

The following proof is an extended version of the proof of Theorem 5.4 in \cite[Bodlaender 1990]{bodlander1990}

\begin{proof}
    It suffices to show that there is a tree in where Bob has a winning strategy with $p+1$ colours.
    
    Consider the graph $G$ as defined in figure \ref{multiPlayerTree1}. 
          
   \begin{figure}[h]
       \centering
        \begin{tikzpicture}[scale=.9, transform shape]
        \tikzstyle{every node}=[circle]; 
        \node [normal] (v7) at (-7.5,1) {};
        \node [normal] (v6) at (-11,1) {};
        \node [normal] (v5) at (-14.5,1) {};
        \node [normal] (v2) at (-18.5,1) {};
        \node [normal] (v1) at (-21,1) {};
        \node [normal] (v3) at (-19,-1) {};
        \node [normal] (v4) at (-17,-1) {};
        \node [ normal] (v11) at (-15,-1) {};
        \node [normal] (v10) at (-13.5,-1) {};
        \node [normal] (v9) at (-11.5,-1) {};
        \node [normal] (v8) at (-10,-1) {};
        \node [normal] (v15) at (-9,-1) {};
        \node [normal] (v16) at (-8,-1) {};
        \node [normal] (v17) at (-6.5,-1) {};
        \node [normal] (v12) at (-20,-1) {};
        \node [normal] (v13) at (-16,-1) {};
        \node [normal] (v14) at (-12.5,-1) {};
        \node [normal] (v18) at (-5,1) {};
        \draw  (v1) edge (v2);
        \draw  (v1) edge (v2);
        \draw  (v2) edge (v3);
        \draw  (v2) edge (v4);
        \draw  (v2) edge (v5);
        \draw  (v5) edge (v6);
        \draw  (v6) edge (v7);
        \draw  (v6) edge (v8);
        \draw  (v6) edge (v9);
        \draw  (v5) edge (v11);
        \draw  (v5) edge (v10);
        \draw  (v2) edge (v12);
        \draw  (v13) edge (v5);
        \draw  (v14) edge (v6);
        \draw  (v15) edge (v7);
        \draw  (v16) edge (v7);
        \draw  (v7) edge (v17);
        \draw  (v7) edge (v18);
        \node at ($(v3)!.5!(v4)$) {\ldots};
        \node at ($(v3)!.5!(v4)$) {\ldots};
        \node at ($(v11)!.5!(v10)$) {\ldots};
        \node at ($(v9)!.5!(v8)$) {\ldots};
        \node at ($(v16)!.5!(v17)$) {\ldots};
        
        \draw [decorate,decoration={calligraphic brace,amplitude=11pt,mirror,raise=2ex}, line width=1.5pt]
        (v12) -- (v4) node[midway,yshift=-3em]{$p$ vertices};
        \end{tikzpicture}
        \caption{}
        \label{multiPlayerTree1}
    \end{figure}    

    
    We give a strategy for Bob with $p+1$ colours. Let the colours be $\{c_1,c_2,\ldots,c_p,c_{p+1}\}$
    On Alice's first move she picks any vertex, $v$, and colours it. Let the colour of $v$ be $c_1$.
    Bobs first move is to colour any vertex with distance 3 to $v$. We now have a subgraph in $G$ of the type shown in figure \ref{subgraphColouring}. We then colour $y_1$ \ldots $y_{p-2}$ with $c_2$ \ldots $c_{p-1}$ respectively.
\begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=1,transform shape]
    \tikzstyle{every node}=[circle]; 
    \node [label=above left:4, normalBlack, label=below right:{\footnotesize$c_1$}] (v6) at (-11.5,1) {};
    \node [label=above left:3, normal] (v5) at (-14.5,1) {};
    \node [label=above left:2, normal] (v2) at (-19.5,1) {};
    \node [label=above left:1, normalBlack, label=below right:{\footnotesize$c_1$}] (v1) at (-22,1) {};
    \node [label=below:$x_1$, normal] (v12) at (-21,-1) {};
    \node [label=below:$x_2$, normal] (v3) at (-20,-1) {};
    \node [label=below:$x_p$, normal] (v4) at (-18.5,-1) {};
    \node [label=below:$y_1$, normalBlack, label=above left:{\footnotesize$c_2$}] (v13) at (-16.5,-1) {};
    \node [label=below:$y_2$, normalBlack, label=above left:{\footnotesize$c_3$}] (v11) at (-15.5,-1) {};
    \node [label=below:$y_{p-2}$, normalBlack, label=above left:{\footnotesize$c_{p-1}$}] (v10) at (-14,-1) {};
    \node [label=below:$y_{p-1}$,normal] (v7) at (-13,-1) {};
    \node [label=below:$y_{p}$,normal] (v8) at (-12,-1) {};
    \draw  (v1) edge (v2);
    \draw  (v2) edge (v3);
    \draw  (v2) edge (v4);
    \draw  (v2) edge (v5);
    \draw  (v5) edge (v6);
    \draw  (v5) edge (v11);
    \draw  (v5) edge (v10);
    \draw  (v2) edge (v12);
    \draw  (v13) edge (v5);   
    \draw  (v5) edge (v7);
    \draw  (v5) edge (v8);
    \node (e1) at ($(v3)!.5!(v4)$) {\ldots};
    \node (e1) at ($(v11)!.5!(v10)$) {\ldots};
    \end{tikzpicture}
    \caption{}
    \label{subgraphColouring}
\end{figure}

    We consider three cases.
    
    \begin{enumerate}
        \item Alice colours $2$, $x_1$, $x_2$, \ldots, or $x_p$.
        
        Bob colours $y_{p-1}$ with $c_p$ and $y_{p}$ with $c_{p+1}$. 
        Vertex $3$ now has $p+1$ different coloured neighbours and thus Bob wins. 
        
        \item Alice colours $3$.
        
        The colour of $3$ cannot be one of $c_1 \ldots c_{p-1}$. Therefore $3$ is either $c_p$ or $c_{p+1}$. 
        W.l.o.g let the colour of $3$ be $c_{p+1}$.
        Bob colours $x_1$ \ldots $x_{p-1}$ with $c_2$ \ldots $c_{p}$ respectively.
        Vertex $2$ now has $p+1$ different coloured neighbours and thus Bob wins. 
        
        \item Alice colours $y_{p-1}$ or $y_{p}$
        
        Bob colours $2$ with $c_p$ and $y_{p}$ (or $y_{p-1}$ if Alice coloured $y_p$) with $c_{p+1}$ .
        Vertex $2$ now has $p+1$ different coloured neighbours and thus Bob wins. 
    \end{enumerate}

    Therefore we have a winning strategy on $G$ in $\mathcal{T}$ for Bob with $p+1$ colours. 

\end{proof}

%TODO: check that these theorems are true.
%  Find counter example to disprove this theorem.
%\begin{theorem}    
%    \[\chi_g(G;p) \leq \chi_g(G;2) + p -2 \]
%\end{theorem}
%
%\begin{proof}
%    
%    By induction on the number of vertices, $n$ and the number of players, $p$.
%    
%    We show for any $p$ $\chi_g(G_{n+1};p) \leq (\chi_g(G_{n+1};2) + p -2)$                   
%    \begin{align}
%    	\chi_g(G_n;p)          & \leq (\chi_g(G_n;2) + p -2)     & \text{from induction} \\
%    	\chi_g(G_n;p)          & \leq \chi_g(G_{n+1};p)          &                       \\
%    	(\chi_g(G_n;2) + p -2) & \leq (\chi_g(G_{n+1};2) + p -2) & 
%    \end{align}
%       
%     Assume, for a contradiction, $\chi_g(G_{n+1};p) > \chi_g(G_{n+1};2) + p -2$. Then for $p=2$  $\chi_g(G_{n+1};2) > \chi_g(G_{n+1};2) + 2 -2$. This is a contradiction, therefore $\chi_g(G_{n+1};p) \leq \chi_g(G_{n+1};2) + p -2$.
%       
%    Claim: For some n $\chi_g(G_n;p) \implies \chi_g(G_n;p+1)$
%    
%    By induction hypothesis $\chi_g(G_n;p) \leq \chi_g(G_n;2) + p -2 $
%    
%\end{proof}
%
%
%\begin{theorem}
%       
%    \[\chi_g(G;p) \leq \chi_g(G;p) +1 \leq \chi_g(G;p+1)\]
%    
%    \[ \chi_g(G;2) + p -2  \leq \chi_g(G;p+1) \]
%    
%\end{theorem}

%#####################################################################################################################
\section{Activation Strategy}
%-------------------------------------------------------------------------------------------------------------------
\subsection{Summery of activation strategy}

Consider a graph $G(v,E)$ with a linear ordering $L$ on $V$. $U$ is the set of unmarked vertices, and $A$ the active ones.

Alice starts by marking the least $v$ in $L$. If $u$ is the last marked vertex by Bob, Alice starts at $u$ activates it and moves to the least unmarked neighbour of $u$, say $w$, in $L$. If $w$ is active Alice markes $w$, if not Alice repeats this on $w$ until she finds an active vertex.

%TODO clearly \chi_g <= col_g 

%TODO trim waffle
\begin{definition}[Kierstead \cite{KIERSTEAD2000}] \label{defnRank}
    Suppose $A,B$ are disjoint subsets of $V$. We say that a matching $M$ is a matching from $A$ to $B$ if $M$ saturates $A$ and $B\setminus A$ contains a cover of M. 
    
    Let $L$ be a linear order, $G=(V,E)$ be a graph, and $u$ a vertex in $V$.
        
    For $u \in V(G)$ the matching number $m(u, L, G)$ of $u$ with respect to $L$ in $G$ is defined to be the size of the largest set $Z \subset N^-[u]$ such that there exists a partition $[X, Y]$ of $Z$ and there exist matchings $M$ from
    $X\subset N^-[u]$ to $V^+(u)$ and $N$ from $Y\subset N^-(u)$ to $V^+[u]$.
    
    Then the rank $r(L,G)$ and rank $r(G)$ are defined as:
    \begin{align*}
    	r(u,L,G) & = d^+_{G_L}(u) + m(u,L,G) \\
    	r(L,G)   & = \max_{u \in V}r(u,L,G)  \\
    	r(G)     & = \min_{L \in \Pi(G)} r(L,G)
    \end{align*}
\end{definition}

\begin{definition} [Activation strategy \cite{KIERSTEAD2000}]
    Let $G=(V, E)$ be a graph and $L$ a linear ordering $V$. We define the activation strategy $S(L,G)$ as follows:
    
    Let U denote the set of unmarked vertices. Alice maintains a subset $A \subset V$ of active vertices. Initially $A = \emptyset$. We activate a vertex $x$ by adding it to $A$. On her first turn Alice activates and marks the least vertex in the ordering $L$. Now suppose that Bob has just marked the vertex $b$. Alice uses algorithm \ref{activStrat_algo} to update A and choose the
    next vertex.
    \begin{algorithm}[h]
        \caption{Activation strategy}
        \label{activStrat_algo}
        \begin{algorithmic}[1]
            \Statex
            \State $x \gets b$ 
            
            \While {$x \notin A$}
                \State $A := A \cup \{x\}$
                \State $s(x) =\min_L(N^+[x] \cap (U \cup \{b\} )$
                \State $x \gets s(x)$
            \EndWhile      
            
            \If{$x \neq b$} 
                \State choose x
            \Else
                \State $y \gets \min_L U$
                \If{$y \neq A$}
                    \State $A \gets A \cup \{y\}$                    
                \EndIf     
                \State choose y
            \EndIf   
        \end{algorithmic}
    \end{algorithm}
    
\end{definition}


\begin{theorem}[Kierstead 1 \cite{KIERSTEAD2000}] \label{KIERSTEAD1}
    For any graph $G=(V, E$) and linear ordering $L$ on $V$, if Alice uses the activation strategy $S(L, G)$ to play the ordering game on $G$, then the score will be at most $1+r(L, G)$. In particular, col\textsubscript{g}$(G) \leq 1+r(G)$.
\end{theorem}

A proof of $\chi_g(G) \leq 18$ is now a matter of finding an ordering $L$ such that by theorem \ref{KIERSTEAD1} $r(G) \leq 17$. See \cite{KIERSTEAD2000}.

%TODO add defination reference
Recall the definition of pathwidth.

Note that $\chi_g(P) \geq w$

\begin{algorithm}[h]
    \caption{Linear order in graph of bounded path width}
    \label{LinOrderPW_algo}
    \begin{algorithmic}[1]
        \Require {$\mathcal{X}=\{X_1,X_2,\dots,X_n\}$ is the path decomposition of a graph $G$}
        \Require {$L$ is a set}
        \Ensure {$L$ is a linear order on $V(G)$}
        
        \State $Q \gets \emptyset$ \Comment $Q$ is a FIFO queue
        \State $L \gets \emptyset$ \Comment our linear order for $V(G)$
       
        \ForAll {$X_i \in \mathcal{X}$}
            \State $Q' \gets Q \cup (X_i\setminus Q)$ \Comment $Q'$ is a FIFO queue
            \State $Q \gets \emptyset$
            \ForAll {$x \in Q'$}
                \If {$x \in \{X_{i+1} \cup \dots \cup X_n\}$}
                    \State $Q \gets Q\cup \{x\}$
                \Else 
                    \State $L \gets L\cup \{x\}$   
                \EndIf    
        \EndFor
       
        \EndFor 
        
    \end{algorithmic}
\end{algorithm}

The following lemma is effectively the definition of the linear order given by algorithm \ref{LinOrderPW_algo}. 

\begin{lemma} \label{neighboursAfter}
    Let $P=(E,V)$ be a graph of bounded pathwidth $w$ and $\{X_1,X_2,\dots,X_n\}$ be a path decomposition of $P$ of width $w$.
    
    Suppose $L$ is a linear ordering on $V$ generated by algorithm \ref*{LinOrderPW_algo} and $u$ is a vertex in $P$. Then there is some $i$ such that $v\in X_i$ and $N^-(v) \subseteq X_i$. Further $i$ is the largest $i$ for which $X_i$ contains $v$. 
\end{lemma}

\begin{proof}
    Let $X_i$ be the segment in which $v$ is added to $L$, that is $i$ is the number of times line 3 has been looped when $v$ is added to $L$.  
    The algorithm adds a vertex $v$ to $L$ iff there is no $j> i$ such that $v \in X_j$. Thus $i$ is the greatest $i$ such that $v \in X_i$. Therefore by definition of path decomposition all the neighbours of $v$ not in the $L$ are in $X_i$. Further the neighbours not in $L$ when $v$ is added to $L$ are greater than $v$ in $L$. Therefore is $N^-(v) \in X_i$.
\end{proof}

\begin{theorem}
    Let $P$ be a graph of bounded pathwidth $w$. Then, 
    \[\chi_g(P) \leq 2w + 2\]
    
\end{theorem}

\begin{proof}
    Suppose $P=(E,V)$ is a graph of bounded pathwidth $w$ and let $\mathcal{X} = \{X_1,X_2,\dots,X_n\}$ be a path decomposition of $P$ with width $w$.
    
    As $\chi_g(P) \leq$ col\textsubscript{g}$(P)$ it suffices to show col\textsubscript{g}$(P) \leq 2w + 3$. We do this by invoking theorem \ref{KIERSTEAD1}.
        
    Let $L$ be a linear ordering on $V$ generated by algorithm \ref*{LinOrderPW_algo}. 
    Let $v$ be any vertex in $V$. 
    
    By the definition of path width $d^+(v) \leq w$ and for all $X \in \mathcal{X}$, $ \left| X \right| \leq w + 1 $. 

    Let $Z\subset N^-[v]$.
    
    By lemma \ref{neighboursAfter} $N^-(v) \subset A$ for some $A \in \mathcal{X}$ . Therefore$\left| Z\right| \leq \left| N^-(v)\right| \leq |A| \leq w+1$. Therefore by definition \ref{defnRank} $m(u,L,P) \leq w+1$ and $r(P) \leq r(L,P) \leq r(u,L,P) \leq 2w+2$. 
    
    Finally by theorem \ref{KIERSTEAD1} col\textsubscript{g}$(P) \leq 2w + 3$
    
\end{proof}

%-------------------------------------------------------------------------------------------------------------------
\subsection{Upper bound using activation strategy for p players}

The activation strategy finds an upper bound of col\textsubscript{g} (The marking game) and as $\chi_g(G) \leq$ col\textsubscript{g} then we have an upper bound for the $\chi_g$. 

We know from \cite{Zhu2008} at any stage, for some unmarked $u$ col\textsubscript{g} $\leq 2 + \max{\left| A \cup N(u)\right| }$, where A is the set of active vertices.

Claim: for $p$ players col\textsubscript{g} $\leq p + \max{ \left| A \cap N(u)\right| }$. 

%-------------------------------------------------------------------------------------------------------------------
\subsection{Refined Activation Strategy}
The refined activation strategy applies the same basic strategy as above but with two differences. 

First, we use a digraph $L$ on $G$ as our ordering. This is only a rough ordering. We partition $V$ into blocks $B_1,B_2,\dots,B_i$, where if $x \in B_i$, $y \in B_j$ and $i <$ then the an edge $xy$ is in $L$. The ordering may not be an ordering in each block. However if we ignore what happens in each block we get a linear ordering.

Second when we activate a vertex $v$ if the edge $uv$ fulfils some conditions then reverse the direction of the edge $uv$ in $L$.

\subsection{Online colouring}

        


















